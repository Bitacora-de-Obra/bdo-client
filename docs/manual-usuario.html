<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Manual de Usuario – Bitácora Digital</title>
  <style>
    :root {
      --brand: #1d4ed8;
      --text: #0f172a;
      --muted: #475569;
      --bg: #f8fafc;
      --card: #ffffff;
      --border: #e2e8f0;
      --accent: #0ea5e9;
    } 
    /* comet */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }
    header {
      background: linear-gradient(135deg, var(--brand), var(--accent));
      color: #fff;
      padding: 48px 32px;
      text-align: center;
    }
    header h1 { margin: 0 0 12px; font-size: 32px; letter-spacing: 0.3px; }
    header p { margin: 4px 0; font-size: 15px; opacity: 0.95; }
    main { max-width: 1080px; margin: -40px auto 48px; padding: 0 24px; }
    section {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 24px;
      margin-bottom: 18px;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.04);
    }
    h2 { margin: 0 0 12px; font-size: 22px; color: var(--brand); }
    h3 { margin: 18px 0 8px; font-size: 17px; color: var(--text); }
    p { margin: 0 0 10px; }
    ul { margin: 0 0 12px 20px; padding: 0; }
    li { margin-bottom: 6px; }
    .tag { display: inline-block; padding: 4px 10px; border-radius: 999px; background: #e0f2fe; color: #0369a1; font-weight: 600; font-size: 12px; letter-spacing: 0.2px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 14px; }
    .card-muted { background: #f1f5f9; border-radius: 10px; padding: 12px 14px; border: 1px dashed var(--border); color: var(--muted); }
    .steps { counter-reset: step; list-style: none; padding: 0; margin: 0; }
    .steps li { counter-increment: step; margin: 10px 0; padding-left: 32px; position: relative; }
    .steps li::before {
      content: counter(step);
      position: absolute; left: 0; top: 0;
      width: 22px; height: 22px;
      border-radius: 6px;
      background: var(--brand); color: #fff;
      display: grid; place-items: center;
      font-size: 12px; font-weight: 700;
    }
    figure { margin: 12px 0; border: 1px solid var(--border); border-radius: 10px; overflow: hidden; background: #fff; }
    figure img { width: 100%; display: block; }
    figure figcaption { padding: 8px 12px; font-size: 13px; color: var(--muted); background: #f8fafc; }
    @media print {
      header, main { margin: 0; padding: 0; box-shadow: none; }
      section { break-inside: avoid; box-shadow: none; }
      #scrollTopBtn { display: none !important; }
    }
    /* Botón flotante "volver arriba" */
    #scrollTopBtn {
      position: fixed;
      right: 24px;
      bottom: 24px;
      width: 44px;
      height: 44px;
      border-radius: 999px;
      border: none;
      background: var(--brand);
      color: #ffffff;
      font-size: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.25);
      cursor: pointer;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease, transform 0.2s ease;
      transform: translateY(8px);
      z-index: 999;
    }
    #scrollTopBtn:hover { transform: translateY(0); background: var(--accent); }
    #scrollTopBtn.scrollTopBtn--visible { opacity: 1; pointer-events: auto; transform: translateY(0); }
  </style>
</head>
<body>
  <header>
    <h1>Manual de Usuario – Bitácora Digital</h1>
    <p>Perfiles, flujo de registro y firmas</p>
    <p class="tag">Versión 1.0 · Actualizado</p>
  </header>

  <main>
    <section id="presentacion">
      <h2>Presentación</h2>
      <p><strong>Bitácora Digital</strong> es tu cuaderno de obra llevado a una experiencia moderna, segura y colaborativa. Centraliza el registro diario de actividades, clima, recursos, hallazgos y evidencias, y automatiza el flujo de revisión y firma para que contratistas e interventorías trabajen sobre una única versión confiable.</p>
      <p>Con roles claros (admin, editor, firmante, viewer), notificaciones oportunas y PDFs listos para archivo, reduces reprocesos, evitas pérdidas de información y aceleras la aprobación. La app se adapta al terreno: captura rápida, adjuntos, firmas manuscritas y estados visibles en tiempo real. Resultado: menos fricción, más trazabilidad y decisiones mejor informadas en cada jornada de obra.</p>
    </section>

    <section>
      <h2>Roles y permisos</h2>
      <div class="grid">
        <div class="card-muted"><strong>Administrador</strong><br />Gestiona proyectos/usuarios, configura la app, crea/edita/elimina bitácoras, aprueba y firma si está asignado.</div>
        <div class="card-muted"><strong>Editor</strong><br />Crea/edita bitácoras, asigna firmantes, aprueba y firma si está asignado.</div>
        <div class="card-muted"><strong>Firmante</strong><br />Puede firmar si tiene tarea asignada (cualquier rol ≠ viewer).</div>
        <div class="card-muted"><strong>Viewer</strong><br />Solo lectura, sin creación ni firma.</div>
      </div>
    </section>

    <section>
      <h2>Recuperar contraseña</h2>
      <ol class="steps">
        <li>En la pantalla de login, haz clic en <strong>“¿Olvidaste tu contraseña?”</strong>.</li>
        <li>Ingresa tu correo y envía la solicitud.</li>
        <li>Revisa tu bandeja (o spam) y sigue el enlace de restablecimiento.</li>
        <li>Define una nueva contraseña y confirma.</li>
      </ol>
      <div class="card-muted">Si no llega el correo: verifica spam o pide a un administrador que valide tu cuenta y reenvíe el enlace.</div>
      <figure>
        <img src="capturas/olvido-password.png" alt="Olvidé mi contraseña" />
        <figcaption>Flujo de recuperación de contraseña</figcaption>
      </figure>
    </section>

    <section>
      <h2>Inicio de sesión y sesión</h2>
      <ul>
        <li>Ingresa con tu usuario y contraseña. La sesión dura 2 horas por token de acceso; el refresh dura 30 días.</li>
        <li>Si ves “token expirado”, inicia sesión de nuevo. Verifica que la hora del dispositivo esté correcta (zona <strong>America/Bogota</strong>).</li>
      </ul>
      <figure>
        <img src="capturas/login.png" alt="Pantalla de login" />
        <figcaption>Pantalla de acceso</figcaption>
      </figure>
    </section>

    <section>
      <h2>Crear una bitácora (admin/editor)</h2>
      <ol class="steps">
        <li>Haz clic en <strong>Registrar Bitácora Diaria</strong>.</li>
        <li>Completa datos básicos: fecha del diario, título (obligatorio), resumen general (obligatorio), tipo de anotación, día del plazo, localización/tramo.</li>
        <li>Condiciones climáticas: resumen, temperatura, notas, intervalos de lluvia (inicio/fin).</li>
        <li>Materiales utilizados: material, cantidad, unidad.</li>
        <li>Recursos:
          <ul>
            <li>Personal del contratista: cargo, cantidad, notas.</li>
            <li>Personal de interventoría: cargo, cantidad, notas.</li>
            <li>Maquinaria y equipos: equipo, estado (operativa/standby), notas.</li>
          </ul>
        </li>
        <li>Ejecución y avance:
          <ul>
            <li>Actividades ejecutadas.</li>
            <li>Cantidades ejecutadas.</li>
            <li>Actividades programadas/no ejecutadas (motivo).</li>
          </ul>
        </li>
        <li>Controles y novedades:
          <ul>
            <li>Ensayos/controles de calidad.</li>
            <li>Materiales recibidos.</li>
            <li>Gestión HSEQ/SST: novedades/contratiempos.</li>
            <li>Visitas registradas.</li>
          </ul>
        </li>
        <li>Hallazgos y respuestas:
          <ul>
            <li>HSEQ: hallazgos y respuesta del contratista.</li>
            <li>Ambiental: hallazgos y respuesta del contratista.</li>
            <li>Social: actividades/observaciones, respuesta social, resumen fotográfico.</li>
          </ul>
        </li>
        <li>Observaciones: contratista, interventoría, adicionales.</li>
        <li>Firmantes responsables: selecciona a quienes firman; puedes desmarcar al autor si solo carga.</li>
        <li>Adjuntos: archivos (PDF/imágenes, ≤10 MB c/u) y fotos (solo imágenes, ≤5 MB c/u).</li>
        <li>Guarda en borrador.</li>
      </ol>
      <figure>
        <img src="capturas/formulario-basico.png" alt="Formulario de bitácora - datos básicos" />
        <figcaption>Datos básicos y clima</figcaption>
      </figure>
      <figure>
        <img src="capturas/formulario-firmantes.png" alt="Selección de firmantes" />
        <figcaption>Selección de firmantes (autor opcional)</figcaption>
      </figure>
    </section>

    <section>
      <h2>Flujo completo de una anotación (de cero a firmado)</h2>
      <ol class="steps">
        <li><strong>Crear borrador</strong>: completa todos los campos (fecha, título, resumen, recursos, firmantes) y guarda.</li>
        <li><strong>Enviar a contratista</strong>: desde el detalle, usa “Enviar a contratista” para pasar a Revisión contratista. El contratista puede agregar observaciones permitidas.</li>
        <li><strong>Revisión de contratista</strong>: si hay ajustes, puedes “Devolver al contratista” o continuar.</li>
        <li><strong>Aprobar para firmas</strong>: la interventoría/admin/editor aprueba y deja la anotación lista para firmar.</li>
        <li><strong>Firmas</strong>: cada firmante asignado ingresa su contraseña de firma; el PDF se actualiza con la firma manuscrita y el estado.</li>
        <li><strong>Exportar PDF final</strong>: genera el PDF con todas las firmas y estados.</li>
      </ol>
      <div class="grid">
        <figure>
          <img src="capturas/flujo-crear.png" alt="Crear borrador" />
          <figcaption>1. Crear borrador</figcaption>
        </figure>
        <figure>
          <img src="capturas/flujo-enviar-contratista.png" alt="Enviar a contratista" />
          <figcaption>2. Enviar a contratista</figcaption>
        </figure>
        <figure>
          <img src="capturas/flujo-aprobar-firmas.png" alt="Aprobar para firmas" />
          <figcaption>3. Aprobar para firmas</figcaption>
        </figure>
        <figure>
          <img src="capturas/flujo-firmar.png" alt="Firma de responsables" />
          <figcaption>4. Firmar y finalizar</figcaption>
        </figure>
      </div>
    </section>

    <section>
      <h2>Edición y flujo de revisión</h2>
      <ul>
        <li>Estados: Borrador → Revisión contratista → Aprobado para firmas → Firmado.</li>
        <li>Editar en Borrador o Revisión final (interventoría). En Revisión contratista, cambios limitados.</li>
        <li>Acciones: Enviar a contratista, Devolver, Aprobar para firmas.</li>
      </ul>
      <figure>
        <img src="capturas/detalle-flujo.png" alt="Detalle de bitácora con acciones" />
        <figcaption>Detalle y acciones del flujo</figcaption>
      </figure>
    </section>

    <section>
      <h2>Asignación y firma</h2>
      <ul>
        <li>Firmantes: cualquier rol ≠ viewer, con tarea asignada.</li>
        <li>Autor no es obligatorio: puedes quitarlo al crear/editar.</li>
        <li>Firma: el firmante ingresa su contraseña de firma; el PDF se actualiza con firma manuscrita y estado.</li>
      </ul>
      <figure>
        <img src="capturas/modal-firma.png" alt="Modal de firma" />
        <figcaption>Proceso de firma</figcaption>
      </figure>
    </section>

    <section>
      <h2>Exportar PDF</h2>
      <ul>
        <li>Usa “Exportar PDF” desde la bitácora.</li>
        <li>Incluye: fecha del diario, tipo, localización, clima (resumen, temperatura, lluvia), materiales, personal, equipos, avance, controles, hallazgos/respuestas, social, observaciones, firmas y estados.</li>
      </ul>
      <figure>
        <img src="capturas/pdf-portada.png" alt="PDF exportado" />
        <figcaption>PDF – portada y datos clave</figcaption>
      </figure>
    </section>

    <section>
      <h2>Notificaciones y tareas pendientes</h2>
      <ul>
        <li>Recibirás notificaciones por: asignación de firma, comentarios con mención, cambios importantes.</li>
        <li>El panel de tareas pendientes muestra firmas y revisiones asignadas. Firma directamente desde la tarjeta o abre el detalle.</li>
        <li>Si no recibes correos: verifica tu correo en perfil, revisa spam y pide al admin confirmar que el servidor de correo esté activo.</li>
      </ul>
      <figure>
        <img src="capturas/notificaciones.png" alt="Notificaciones y tareas" />
        <figcaption>Panel de tareas/alertas</figcaption>
      </figure>
    </section>

    <section>
      <h2>Subir tu firma manuscrita</h2>
      <ol class="steps">
        <li>Ve a tu perfil / sección “Mi firma”.</li>
        <li>Sube la imagen (PNG/JPG) o dibuja en el lienzo, guarda.</li>
        <li>Tu firma quedará asociada y podrás usarla al firmar una bitácora.</li>
      </ol>
      <div class="card-muted">Formato recomendado: fondo transparente, buena resolución, archivo menor a 1 MB.</div>
      <figure>
        <img src="capturas/subir-firma.png" alt="Subir firma manuscrita" />
        <figcaption>Registro de firma manuscrita</figcaption>
      </figure>
    </section>

    <section>
      <h2>Comentarios y menciones</h2>
      <ul>
        <li>Menciones: usa <code>@[userId]</code> para notificar.</li>
        <li>Permisos dependen del estado y rol (admin/editor/autor/firmante/assignado).</li>
      </ul>
      <figure>
        <img src="capturas/comentarios.png" alt="Comentarios con menciones" />
        <figcaption>Comentarios y menciones</figcaption>
      </figure>
    </section>

    <section>
      <h2>Resolución de problemas</h2>
      <div class="grid">
        <div class="card-muted"><strong>Token expirado / 401 refresh</strong><br />Reinicia sesión; verifica que el navegador envíe cookie de refresh (HTTPS). Hora del sistema correcta.</div>
        <div class="card-muted"><strong>P2000 al crear</strong><br />Texto muy largo en campos: recortar o avisar; se ampliaron descripciones/actividades.</div>
        <div class="card-muted"><strong>Fecha corrida</strong><br />Usar la UI actual; re-editar y guardar. Las fechas se fijan a mediodía UTC.</div>
        <div class="card-muted"><strong>Firmas/estados en PDF</strong><br />Re-exportar; si persiste, reportar folio.</div>
      </div>
    </section>

    <section>
      <h2>Soporte</h2>
      <p>Contacto interno / Mesa de ayuda del proyecto.</p>
      <p>Versión de la aplicación y del manual.</p>
    </section>
  </main>

  <!-- Botón flotante "volver arriba" -->
  <button id="scrollTopBtn" aria-label="Volver arriba" title="Volver arriba">↑</button>

  <script>
    const scrollTopBtn = document.getElementById('scrollTopBtn');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 300) {
        scrollTopBtn.classList.add('scrollTopBtn--visible');
      } else {
        scrollTopBtn.classList.remove('scrollTopBtn--visible');
      }
    });
    scrollTopBtn.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  </script>
</body>
</html>
